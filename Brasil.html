<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vetnil Produtos</title>
  <style>

    *{
        margin: 0;
    }
    
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f5f5f5;
    }

    /* Cabe√ßalho */
    header {
      height: 5vh;
      background-color: #006d4f;
      color: white;
      padding: 15px 30px;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
    }

    .logo {
      font-size: 2vh;
      font-weight: bold;
    }

.distribuidor {
  display: flex;
  justify-content: space-between;
  align-items: center;          /* Garante o alinhamento vertical centralizado */
  padding: 0 2.5vh;             /* Espa√ßamento nas laterais */
  gap: 20px;                    /* Adiciona um espa√ßo m√≠nimo entre os elementos */
}

.distribuidorBandeira {
  flex-shrink: 0; /* Evita que a bandeira encolha */
}

    .distribuidor img {
      border-radius: 14px;
      width: 8vh;
      height: 5vh;
      border: 4px solid white;
    }

    .distr{
        height: 10vh;
        padding-top: 20px;
        padding-bottom: 20px;
        color: white;
        background-color: #009b6f;
    }

    .distr h3{
        font-size: 1.8vh;
        padding-left: 2.5vh;
        font-weight: bold;
        padding-bottom: 15px;
    }



    
.info p, .contatos p, .info a, .contatos a {
  /* Usando clamp() para uma fonte responsiva e controlada */
  /* M√≠nimo 14px, preferencial 1.2vw, m√°ximo 22px */
  font-size: 1.5vw;
  line-height: 1.5; /* Melhora a legibilidade */
  color: white; /* Garante que os links fiquem brancos tamb√©m */
  margin: 2px 0; /* Pequeno espa√ßamento vertical entre as linhas de texto */
}


    .info {
  flex-grow: 1;                 /* Faz este bloco crescer para ocupar o espa√ßo livre */
  text-align: left;             /* Alinha o texto √† esquerda dentro deste bloco */
}

.contatos {
  flex-shrink: 0;               /* Evita que o bloco de contatos encolha e quebre linha */
  text-align: right;            /* Alinha o texto √† direita dentro deste bloco */
}

.contatos a {
    text-decoration: none;
}


    /* √çcone Home */
    .home-icon {
      font-size: 22px;
      background: white;
      color: #006d4f;
      padding: 8px;
      border-radius: 50%;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Grid de produtos */
    .produtos {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      padding: 30px;
      width: 95vw;
      margin: auto;
    }

    .produto {
      background: white;
      border-radius: 8px;
      box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
      height: 16vh;
      padding: 10px;
    }

    .produto p {
      margin: 0;
      color: #006d4f;
      font-weight: bold;
      font-size: 1.2vh;
    }


    .produto img{max-width:80vw;max-height:25vw;object-fit:contain;margin-bottom:8px}

    footer{
        height: 50px;
        background-color: rgb(0, 87, 0);
    }
  </style>
</head>

<body>
  <header>
    <div class="header-container">
      <div class="logo" id="logo">VETNIL¬Æ</div>
      <a id="homeLink" href="index.html" class="home-icon" title="Voltar ao in√≠cio">üè†</a>
    </div>
  </header>

  <main>
    <!-- Distribuidor -->
    <div class="distr">
      <h3>Distribuidor:</h3>

      <div class="distribuidor">
          <div class="distribuidorBandeira">
              <img id="flagImg" src="" alt="Bandeira" />
          </div>
          
          <div class="info">
              <div id="dist"></div>
              <div id="distRazaoSocial"></div>
              <div id="distEndereco"></div>
          </div>

          <div class="contatos">
              <div id="distTelefone"></div>
              <div id="distEmail"></div>
              <div id="distSite"></div>
          </div>
      </div>
    </div>

    <!-- Grid din√¢mica de produtos -->
    <div id="produtosGrid" class="produtos"></div>
  </main>



  <!-- ===== COLE AQUI O CSV DE PRODUTOS =====
       Cabe√ßalho: Produto,<Pa√≠s1>,<Pa√≠s2>,...
       Marque X/‚úì/‚úî onde o produto est√° dispon√≠vel.  -->
  <script id="csv-produtos" type="text/plain">
;PRODUTOS X PA√çSES;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;
;PRODUTO;Mexico;Chile;Peru;Uruguay;Colombia;Paraguay;Costa Rica;Panama;Ecuador;Bolivia;Dominican Republic;Slovenia;United Arab Emirates;Brazil;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;
1;Acepran 0,2%;;;;;;;;;;;X;X;;;;;;;;;;;;;
2;Acepran Gotas;;;;;;;;;;;X;X;;;;;;;;;;;;;
3;Alantol;;;X;;;X;;X;;x;X;X;;;;;;;;;;;;;
4;Aminomix Pet;;;;;X;X;;X;;x;X;X;X;;;;;;;;;;;;
5;Aminomix Pet Comprimido;;;X;;;;X;;;;;;;;;;;;;;;;;;
6;Aminomix Pet P√≥;;X;;X;;;;;X;;;;;;;;;;;;;;;;
;Aurivet¬Æ Clean pH Neutro;;;;;;;;;;;;;;X;;;;;;;;;;;
7;Cal-d-mix Pet;X;;;X;;;;;;x;X;X;;;;;;;;;;;;;
8;Condroton Injetavel;;;;;X;X;;;;x;X;X;;;;;;;;;;;;;
9;Condroton Comprimidos;;;;;X;X;;X;;;;X;;;;;;;;;;;;;
10;Doxiciclina Vetnil Solu√ß√£o Injet√°vel;;;;;;X;;;;x;;X;;X;;;;;;;;;;;
11;Enterex;X;;X;;X;;X;X;;x;X;X;;;;;;;;;;;;;
12;Eletrolitico Pet;;X;X;X;X;;;;;x;X;X;X;;;;;;;;;;;;
;Firocoxib Vetnil¬Æ Comprimido;;;;;;;;;;;;;;X;;;;;;;;;;;
13;Geripet Comprimido;;;X;X;X;X;X;;;;;X;;;;;;;;;;;;;
14;Glicopan Pet;X;X;X;X;X;X;X;X;X;x;X;X;X;;;;;;;;;;;;
15;Hidrovit;;;;;;;;;;;;;X;;;;;;;;;;;;
16;Hemolitan Pet ;X;X;X;X;X;X;X;X;X;x;X;X;X;;;;;;;;;;;;
17;Hemolitan Pet Comprimidos;X;X;X;X;X;X;X;X;X;X;X;X;X;;;;;;;;;;;;
18;Hemolitan Gold Comprimidos;;;;X;;;;;;;;X;;;;;;;;;;;;;
19;Hepvet ;;;;X;X;X;X;X;;x;;X;;;;;;;;;;;;;
20;Hepvet Comprimidos;;;;;;;;;X;; ;;;;;;;;;;;;;;
21;Keravit;;;;;;;;;;;X;X;;;;;;;;;;;;;
;Meloxinew¬Æ 0,2% Injet√°vel;;;;;;;;;;;;;;X;;;;;;;;;;;
22;Nutralife 14g;;X;;;;X;;;;;;X;;;;;;;;;;;;;
23;Nutralife Intensiv;;X;;;X;;;X;X;;X;X;;;;;;;;;;;;;
;Optivet¬Æ clean;;;;;;;;;;;;;;X;;;;;;;;;;;
24;Organew Pet;;X;X;X;X;X;X;X;X;x;X;X;X;;;;;;;;;;;;
25;Organew Pet Pasta;;;;;X;;X;X;;x;;X;;;;;;;;;;;;;
26;Pelo e Derme Gold;;X;;;;;X;;X;;;X;;;;;;;;;;;;;
27;Pelo e Derme 750 e 1500;;;X;X;X;;;X;;x;X;X;;;;;;;;;;;;;
28;Periovet ;;;;;;; ;;;;;X;;;;;;;;;;;;;
29;Pet Milk;;;X;X;;;;X;;x;;X;;;;;;;;;;;;;
30;Petprazol;;;X;;;;;;;;X;X;;;;;;;;;;;;;
31;Probi√≥tico Vetnil C√£es e Gatos;;;;;;;;;X;;;X;;;;;;;;;;;;;
32;Quetamina Injet√°vel Vetnil;;;;;;;;;;;X;X;;;;;;;;;;;;;
33;Vita-Vet C;;X;;X;X;X;;X;X;x;;X;;;;;;;;;;;;;
34;Vetmax plus Suspens√£o;;;;;;X;X;X;;;;X;;;;;;;;;;;;;
35;Vetmax plus Comprimido;;;;;;X;X;X;;;;X;;;;;;;;;;;;;
36;Vetagl√≥s;;;;;;;;;;x;X;X;;;;;;;;;;;;;
;Vetnidazol¬Æ Comprimidos;;;;;;;;;;;;;;X;;;;;;;;;;;
;Vetnil¬Æ Skin Care Clean;;;;;;;;;;;;;;X;;;;;;;;;;;
;Vetnil¬Æ Skin Care Defense;;;;;;;;;;;;;;X;;;;;;;;;;;
;Vetnil¬Æ Skin Care Hidrat;;;;;;;;;;;;;;X;;;;;;;;;;;
  </script>

  <!-- ===== COLE AQUI O CSV DE DISTRIBUIDORES =====
       Colunas suportadas: Pais,Nome,RazaoSocial,Endereco,Telefone,Email,Site,Bandeira
       (as que n√£o tiver, deixe vazias). -->
  <script id="csv-distribuidores" type="text/plain">
Pa√≠s;Distribuidor;Raz√£o Social;Endere√ßo;Telefone;Email;Site
Mexico;MEDERILAB;MEDERI LAB S.A.P.I. de C.V.;Puerto Yavaros, #2751 , Col. Miramar , Col. Miramar, Zapopan Jalisco - Mexico;+52 10-28-36-76;direccion@mederilab.com;http://www.mederilab.com
Chile;GABRICA;GABRICA CHILE LTDA;Av Lautaro, 301 , Bodega 02 , Quilicura, Santiago - Chile;+562 366 1163;direccion@gabrica.cl;http://www.gabrica.cl
Peru;INVETSA;INVERSIONES VETERIN√ÅRIAS S.A.;Av. Del Pinar, 180 , Oficina 1101 , Chacarilla, Lima - Peru;+511 617 5353;yysa@invetsa.com;http://www.invetsa.com
Uruguay;SADENIR;SADENIR S.A. IMPORT√ÅCION Y DISTRIBUCI√ìN;Av. Aerosur, Manzana, 50 , Solar 24 , San Jos√© de Carrasco, Canelones - Uruguay;+598 2682 3312;info@sadenir.com.uy;http://www.sadenir.com.uy
Colombia;GABRICA;GABRICA S.A.S.;Calle 164, 15-29 , Toberin, Bogot√° - Colombia;+571 519 0040 - +571 668 4444;serviciocliente@gabrica.com.co;http://www.gabrica.com
Paraguay;AGROVETERINARIA CENTRAL S.R.L;AGROVETERINARIA CENTRAL S.R.L;Av. Gaspar Rodrigues de Francia entra Av Peru y Pai Perez, Paraguai - Paraguay;+595 0982319879;gerencia@agroveterinariacentral.com.py;https://m.facebook.com/pg/agrovetcentralpy/community/
Costa Rica;AGEAGRO;AGENTES AGROVETERIN√ÅRIOS;San Isidro de Coronado, 600 metros nor , Vazquez de Coronado, San Jose - Costa Rica;+506 2294 6821;danielalpizar@ageagro.com;http://www.ageagro.com
Panama;REFARMIL;REFARMIL EXPORT & IMPORT S/A;CL 15 Rio Abajo, - , Rio Abajo, Panam√° - Panama;+507 224 8225;goperaciones@refarmil.com;http://www.refarmil.com
Ecuador;ILIANZA S.A.;ILIANZA S.A.;Jose Maria Velasco Ibarra, - , Guayaquil, Equador - Ecuador, CEP: 090615;+593 99 962 7512;rcaputim@ilianza.com;https://ilianza.com/
Bolivia;MULTIAGRO;MULTIAGRO SERVICIOS AGROP. Y VETERINARIOS LTDA;Av. Pira√≠, 462 , Urbari, Santa Cruz - Bolivia;+591 3 353 5060;multiagro@cotas.com.bo;http://www.multiagro.com.bo
Dominican Republic;HVAH - Arroyo Hondo;HOSPITAL VETERINARIO ARROYO HONDO;C. Euclides Morillo, 76 , Arroyo Hondo, Santo Domingo - Dominican Republic;+809 412 2042;mmallen@hvahrd.com;http://www.vetarroyohondo.com
Slovenia;BTL;BTL MARKETING D.O.O.;Zaloznikova ulica, 43 , 1351 Brezovica pri Ljubljani , Brezovica pri, Slovenia - Slovenia;+386 1 365 7810;damjana@btl-m.si;http://www.petshop.si
United Arab Emirates;GULF RIDER;GULF RIDER VETERINARY MEDICINE & EQUIPMENT TRADING;Al Qusais , 3 , P.O. Box 20629 , Industrial Area, Dubai - United Arab Emirates;+971 4 2675881;fisal@gulfrider.com;http://www.gulfrider.com

  </script>

  <script>
  // ===== Utils =====
  // === Caminhos de imagem por produto (preencha aqui) ===
// ATEN√á√ÉO: o nome tem que ser exatamente como est√° no CSV (acentos, espa√ßos, %, etc.)
const PRODUCT_IMG = {
  // Exemplo:
  // 'Glicopan Pet': './images/produtos/glicopan-pet/glicopan-pet.png',
  // 'Vetmax plus Suspens√£o': './images/produtos/vetmax-plus-suspensao/vetmax-plus-suspensao.png',
  'Acepran 0,2%': './images/produtos/01_ACEPRAN 0,2ÔøΩ/Acepran_0,2ÔøΩ_site.png',
  'Acepran Gotas': './images/produtos/02_ACEPRAN GOTAS/Acepran_Gotas_site.png',
  'Alantol': './images/produtos/03_ALANTOL/Packshot-Alantol_pet_site_V2.png',
  'Aminomix Pet': './images/produtos/04_AMINOMIX PET/Packshot_Aminomix-Pet_site_V3.png',
  'Aminomix Pet Comprimido': './images/produtos/05_AMINOMIX PET COMP/Aminomix-Pet_120-comp_site_V2.png',
  'Aminomix Pet P√≥': './images/produtos/06_AMINOMIX PET P√ì/Packshot_Aminomix100-500-Pet_site_V2.png',
  'Aurivet¬Æ Clean pH Neutro': './images/produtos/',
  'Cal-d-mix Pet': './images/produtos/07_CAL-D-MIX PET/Packshot_Cal-D-Mix_pet_site.png',
  'Condroton Injetavel': './images/produtos/08_CONDROTON INJET√ÅVEL/Condroton-Injet√°vel-10ml_pet_site.png',
  'Condroton Comprimidos': './images/produtos/09_CONDROTON COMPRIMIDOS/Pack_Condroton-Comp_site.png',
  'Doxiciclina Vetnil Solu√ß√£o Injet√°vel': './images/produtos/10_DOXICICLINA VETNIL SOLU√á√ÉO INJET√ÅVEL/Doxiciclina Inj_site.png',
  'Enterex': './images/produtos/11_ENTEREX/Enterex_8g_site.png',
  'Eletrolitico Pet': './images/produtos/12_ELETROL√çTICO PET/Eletrolitico-Pet_10g_site.png',
  'Firocoxib Vetnil¬Æ Comprimido': './images/produtos/',
  'Geripet Comprimido': './images/produtos/13_GERIPET COMPRIMIDO/Geripet 30 comp_site.png',
  'Glicopan Pet': './images/produtos/14_GLICOPAN PET/Packshot_Glicopan Pet_site.png',
  'Hidrovit': './images/produtos/15_HIDROVIT/Packshot_Hidrovit_passaro_site_V2.png',
  'Hemolitan Pet': './images/produtos/16_HEMOLITAN PET/Packshot_Hemolitan_liq._site_V2.png',
  'Hemolitan Pet Comprimidos': './images/produtos/17_HEMOLITAN PET COMPRIMIDOS/Hemolitan Pet 30 comp_site.png',
  'Hemolitan Gold Comprimidos': './images/produtos/18_HEMOLITAN GOLD COMPRIMIDOS/Hemolitan Gold 30 comp.png',
  'Hepvet': './images/produtos/19_HEPVET/Packshot_Hepvet_V3.png',
  'Hepvet Comprimidos': './images/produtos/20_HEPVET COMP/Hepvet_30 Comp_site_V2.png',
  'Keravit': './images/produtos/21_KERAVIT/Keravit-5g_Pet_site_V2.png',
  'Meloxinew¬Æ 0,2% Injet√°vel': './images/produtos/',
  'Nutralife 14g': './images/produtos/22_NUTRALIFE 14G/Nutralife_14g_site_V2.png',
  'Nutralife Intensiv': './images/produtos/23_NUTRALIFE INTENSIV/Nutralife Intensiv_site_V3.png',
  'Optivet¬Æ clean': './images/produtos/',
  'Organew Pet': './images/produtos/24_ORGANEW PET/Organew_100g_site_V2.png',
  'Organew Pet Pasta': './images/produtos/25_ORGANEW PET PASTA/Organew_12g_site.png',
  'Pelo e Derme Gold': './images/produtos/26_PELO E DERME GOLD/Packshot_Pelo & Derme_site.png',
  'Pelo e Derme 750 e 1500': './images/produtos/27_PELO E DERME 750 E 1500/Packshot_Pelo e Derme_750+1500_V2.png',
  'Periovet': './images/produtos/28_PERIOVET/Packshot_Periovet_site_set24.png',
  'Pet Milk': './images/produtos/29_PET MILK/Packshot_Pet-Milk_site_V2.png',
  'Petprazol': './images/produtos/30_PETPRAZOL/Packshot_Petprazol_site.png',
  'Probi√≥tico Vetnil C√£es e Gatos': './images/produtos/31_PROBI√ìTICO VETNIL C√ÉES E GATOS/Probiotico_14g_site_V2.png',
  'Quetamina Injet√°vel Vetnil': './images/produtos/32_QUETAMINA INJET√ÅVEL VETNIL/Quetamina_10mL_site.png',
  'Vita-Vet C': './images/produtos/33_VITA-VET C/Vita Vet C 30 ml_site.png',
  'Vetmax plus Suspens√£o': './images/produtos/34_VETMAX SUSPENSAO/Vetmax-Susp.-Oral_site.png',
  'Vetmax plus Comprimido': './images/produtos/35_VETMAX PLUS COMPRIMIDO/Vetmax-Plus-4-comp_site_V3.png',
  'Vetagl√≥s': './images/produtos/36_VETAGL√ìS/Vetagl√≥s_20g_site_V2.png',
  'Vetnidazol¬Æ Comprimidos': './images/produtos/',
  'Vetnil¬Æ Skin Care Clean': './images/produtos/',
  'Vetnil¬Æ Skin Care Defense': './images/produtos/',
  'Vetnil¬Æ Skin Care Hidrat': './images/produtos/'
};

  function getParam(name){ return new URL(location.href).searchParams.get(name); }

  function parseCSV(text){
    const first = text.split(/\r?\n/).find(l => l.trim());
    const d = first?.includes('\t') ? '\t' : first?.includes(';') ? ';' : ',';
    const rows=[], re=/\r\n|\n|\r/g; text=(text||'').replace(re,'\n');
    let i=0, cur=[], val='', q=false;
    while(i<text.length){
      const ch=text[i];
      if(q){ if(ch=='"'){ if(text[i+1]=='"'){val+='"'; i++;} else q=false; } else val+=ch; }
      else { if(ch=='"') q=true; else if(ch==d){cur.push(val.trim()); val='';}
        else if(ch=='\n'){cur.push(val.trim()); rows.push(cur); cur=[]; val='';}
        else val+=ch; }
      i++;
    }
    if(val.length||cur.length){cur.push(val.trim()); rows.push(cur);}
    // remove linhas totalmente vazias
    return rows.filter(r => r.length && r.some(c => c !== ''));
  }

  function loadCSVInline(id){
    const el = document.getElementById(id);
    return parseCSV((el.textContent || '').trim());
  }

  // ===== Slugs (produto -> id dos docs em produtos.html) =====
const PRODUCT_SLUG = {
  // exce√ß√µes onde o doc usa um nome diferente do CSV
  'Cal-d-mix Pet': 'cal-d-mix',
  'Vetmax plus Suspens√£o': 'vetmax-plus-suspens-o',
  'Vetmax plus Comprimido': 'vetmax-plus-comp',
  'Aminomix Pet P√≥': 'aminomix-pet-po',
  'Hepvet Comprimidos': 'hepvet-comp',
  'Probi√≥tico Vetnil C√£es e Gatos': 'probiotico-vetnil-c-es-e-gatos',
  'Pelo e Derme 750 e 1500': 'pelo-e-derme-750-1500',
  // adicione aqui se aparecer algum ‚Äún√£o encontrado‚Äù no produtos.html
};

// slug autom√°tico (fallback) ‚Äî remove acento, troca n√£o-alfanum por "-"
function autoSlug(nome){
  return (nome||'')
    .normalize('NFD').replace(/\p{Diacritic}/gu,'')
    .toLowerCase()
    .replace(/[%.,/()¬Æ¬∞¬∫¬™+]+/g,' ')   // tira s√≠mbolos chatos
    .replace(/\s+/g,'-')              // espa√ßos -> h√≠fen
    .replace(/-+/g,'-')               // hifens duplos
    .replace(/^-|-$/g,'');            // bordas
}

  // ===== Produtos =====
  // Encontra a linha de cabe√ßalho cuja primeira c√©lula √© "PRODUTO" (case-insensitive)
  function findProdutosHeader(rows){
  for(let r=0;r<rows.length;r++){
    for(let c=0;c<rows[r].length;c++){
      const cell = (rows[r][c]||'').normalize('NFD').replace(/\p{Diacritic}/gu,'').toUpperCase();
      if(cell === 'PRODUTO'){ // no seu CSV est√° na 2¬™ coluna
        // (se quiser, d√° pra detectar tamb√©m uma coluna "IMAGEM" aqui)
        return { headerRow: r, nameCol: c };
      }
    }
  }
  throw new Error('Cabe√ßalho de produtos n√£o encontrado (PRODUTO).');
}

function mapProdutos(rows){
  const pos = findProdutosHeader(rows);
  const headers = rows[pos.headerRow];          // linha do cabe√ßalho
  const items   = rows.slice(pos.headerRow+1);  // dados
  return { headers, items, nameCol: pos.nameCol };
}

function produtosParaPais(model, pais){
  const { headers, items, nameCol } = model;
  const idxPais = headers.indexOf(pais);
  if(idxPais < 0) return [];
  return items
    .filter(r => ((r[idxPais]||'').trim().toUpperCase()).match(/^(X|‚úì|‚úî)$/))
    .map(r => ({ nome: r[nameCol] || 'Nome produto' }));
}

function renderProdutos(lista){
  const pais = getParam('pais');
  const grid = document.getElementById('produtosGrid');
  grid.innerHTML = '';
  if(!lista.length){
    grid.innerHTML = '<div style="grid-column:1/-1;opacity:.7">Nenhum produto para este pa√≠s.</div>';
    return;
  }
  for(const p of lista){
    const slug = PRODUCT_SLUG[p.nome] || autoSlug(p.nome);
    const url = `produtos.html?pais=${encodeURIComponent(pais)}&produto=${encodeURIComponent(slug)}`;

    const card = document.createElement('a');
    card.className = 'produto';
    card.href = url;
    card.style.textDecoration = 'none';

    const src = PRODUCT_IMG[p.nome];
    if(src){
      const img = document.createElement('img');
      img.loading = 'lazy';
      img.alt = p.nome;
      img.src = src;
      img.onerror = function(){ this.remove(); };
      card.appendChild(img);
    }

    const label = document.createElement('p');
    label.textContent = p.nome;
    label.style.color = '#006d4f';
    label.style.fontWeight = 'bold';
    card.appendChild(label);

    grid.appendChild(card);
  }
}

  // ===== Distribuidor =====
  // Seu CSV: "PA√çS;IDIOMA;DISTRIBUIDOR" (todo conte√∫do em uma √∫nica coluna)
 function findDistHeader(rows){
  const norm = s => (s||'').normalize('NFD').replace(/\p{Diacritic}/gu,'').toUpperCase();
  for (let i = 0; i < rows.length; i++) {
    const H = rows[i].map(norm);
    const idx = {
      pais:        H.indexOf('PAIS'),
      dist:        H.indexOf('DISTRIBUIDOR'),
      razao:       H.indexOf('RAZAO SOCIAL'),
      endereco:    H.indexOf('ENDERECO'),
      telefone:    H.indexOf('TELEFONE'),
      email:       H.indexOf('EMAIL'),
      site:        H.indexOf('SITE'),
    };
    if (idx.pais >= 0 && idx.dist >= 0) {
      return { row: i, idx };
    }
  }
  return null;
}

function distribuidorPorPais(rows, pais){
  const found = findDistHeader(rows);
  if (!found) return null;
  const { row, idx } = found;
  const data = rows.slice(row + 1);
  const r = data.find(line => (line[idx.pais] || '') === pais);
  if (!r) return null;
  return {
    pais,
    nome:      r[idx.dist]      || '',
    razao:     idx.razao    >=0 ? (r[idx.razao]    || '') : '',
    endereco:  idx.endereco >=0 ? (r[idx.endereco] || '') : '',
    telefone:  idx.telefone >=0 ? (r[idx.telefone] || '') : '',
    email:     idx.email    >=0 ? (r[idx.email]    || '') : '',
    site:      idx.site     >=0 ? (r[idx.site]     || '') : ''
  };
}

function renderDistribuidor(pais, d){
  document.title = `Produtos ‚Äî ${pais}`;
  setFlagImage(pais);
  // const flag = document.getElementById('flagImg');
  // const fallbackFlag = `./images/Bandeiras Paises/${encodeURIComponent(pais)}.png`;
  // flag.src = fallbackFlag;
  // flag.alt = `Bandeira de ${pais}`;

  // limpa
  const set = (id, html) => { const el = document.getElementById(id); if (el) el.innerHTML = html || ''; };

  if (d) {
    set('distPais', `<p><strong>${d.pais}</strong></p>`);
    set('dist', d.nome ? `<p>${d.nome}</p>` : '');
    set('distRazaoSocial', d.razao ? `<p>${d.razao}</p>` : '');
    set('distEndereco', d.endereco ? `<p>${d.endereco}</p>` : '');
    set('distTelefone', d.telefone ? `<p>${d.telefone}</p>` : '');
    set('distEmail', d.email ? `<p><a href="mailto:${d.email}" style="color:#fff">${d.email}</a></p>` : '');
    set('distSite', d.site ? `<p><a href="${d.site}" target="_blank" rel="noopener" style="color:#fff">${d.site}</a></p>` : '');
  } else {
    set('distPais', `<p><strong>${pais}</strong></p>`);
    set('dist', '<em>Distribuidor n√£o informado.</em>');
    set('distRazaoSocial','');
    set('distEndereco','');
    set('distTelefone','');
    set('distEmail','');
    set('distSite','');
  }
}

// === Bandeiras ===
const FLAG_BASE = './images/Bandeiras Paises/'; // <- pasta correta

// mapeia o nome do CSV -> basename do arquivo da bandeira
const FLAG_MAP = {
  'Mexico': 'MEXICO',
  'Chile': 'CHILE',
  'Peru': 'PERU',
  'Uruguay': 'URUGUAI',
  'Colombia': ['COLOMBIA','Comlombia'], // tenta os dois (cobre o typo do arquivo)
  'Paraguay': 'PARAGUAI',
  'Costa Rica': 'CostaRica',
  'Panama': 'PANAMA',
  'Ecuador': 'ECUADOR',
  'Bolivia': 'BOLIVIA',
  'Dominican Republic': 'REPUBLICADOMINICANA',
  'Slovenia': 'SLOVENIA',
  'United Arab Emirates': 'EMIRADOSARABES',
  'Brazil': 'Brasil'
};

// ordem de extens√µes a tentar
const FLAG_EXTS = ['.png', '.svg', '.webp', '.jpg', '.jpeg'];

// util pra gerar candidatos
function* flagCandidates(pais){
  const baseNames = FLAG_MAP[pais] ? (Array.isArray(FLAG_MAP[pais]) ? FLAG_MAP[pais] : [FLAG_MAP[pais]]) : [];
  // 1) nomes do mapa
  for (const b of baseNames){
    for (const ext of FLAG_EXTS){
      yield encodeURI(FLAG_BASE + b + ext);
    }
  }
  // 2) fallback: nome do pa√≠s ‚Äúslugado‚Äù
  const slug = (pais||'').normalize('NFD').replace(/\p{Diacritic}/gu,'').replace(/[^a-z0-9]+/gi,'').toUpperCase();
  for (const ext of FLAG_EXTS){
    yield encodeURI(FLAG_BASE + slug + ext);
  }
  // 3) fallback final: nome original com espa√ßo (pouco prov√°vel, mas n√£o custa)
  for (const ext of FLAG_EXTS){
    yield encodeURI(FLAG_BASE + pais + ext);
  }
}

function setFlagImage(pais){
  const img = document.getElementById('flagImg');
  if(!img) return;
  img.alt = `Bandeira de ${pais}`;
  img.loading = 'lazy';

  const iter = flagCandidates(pais);
  const tryNext = () => {
    const next = iter.next();
    if (next.done){ img.remove(); return; }  // sem bandeira? remove o <img> pra n√£o quebrar layout
    img.src = next.value;
  };
  img.onerror = tryNext;
  tryNext();
}

  // ===== Boot =====
  (function boot(){
    const pais = getParam('pais');
    if(!pais){ location.href = 'index.html'; return; }
    document.getElementById('homeLink').href = 'index.html';

    try{
      const prodRows = loadCSVInline('csv-produtos');
      const distRows = loadCSVInline('csv-distribuidores');

      const model = mapProdutos(prodRows);
      const lista = produtosParaPais(model, pais);
      const dist = distribuidorPorPais(distRows, pais);

      renderDistribuidor(pais, dist);
      renderProdutos(lista);
    }catch(err){
      console.error(err);
      document.getElementById('produtosGrid').innerHTML =
        '<div style="grid-column:1/-1;color:#b00020">Erro ao carregar dados embutidos.</div>';
    }
  })();
</script>
</body>
<footer></footer>
</html>